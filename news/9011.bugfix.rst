New Resolver: Rework backtracking and state management, to avoid getting stuck in an infinite loop.
